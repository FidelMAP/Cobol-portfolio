       IDENTIFICATION DIVISION.
       PROGRAM-ID. LOAN_UPDATE_ONLINE.
       AUTHOR. YOUR-NAME.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT LOAN-FILE ASSIGN TO 'LOANS.DAT'
               ORGANIZATION IS INDEXED
               ACCESS MODE IS SEQUENTIAL
               RECORD KEY IS LOAN-ID
               FILE STATUS IS WS-FS.

       DATA DIVISION.
       FILE SECTION.
       FD LOAN-FILE.
       01 LOAN-RECORD.
           05 LOAN-ID        PIC 9(6).
           05 CLIENT-ID      PIC 9(6).
           05 AMOUNT         PIC 9(9)V99.
           05 INTEREST       PIC 9(3)V99.
           05 TERM-MONTHS    PIC 9(3).
           05 STATUSS        PIC X(10).
           05 PAID-MONTHS    PIC 9(3).

       WORKING-STORAGE SECTION.
       01 WS-LOAN-ID       PIC 9(6) VALUE 0.
       01 WS-PAYMENTS      PIC 9(3) VALUE 0.
       01 WS-FS            PIC XX.

       88 FILE-EOF VALUE '10'.  *> End of file (optional, dependiendo de COBOL)
       88 FILE-OK  VALUE '00'.

       PROCEDURE DIVISION.
           OPEN I-O LOAN-FILE

           PERFORM UNTIL WS-LOAN-ID = 0
               DISPLAY 'Enter Loan ID to update (0 to exit): '
               ACCEPT WS-LOAN-ID
               IF WS-LOAN-ID = 0
                   EXIT PERFORM
               END-IF

               DISPLAY 'Enter number of payments to add: '
               ACCEPT WS-PAYMENTS

               READ LOAN-FILE
                   INVALID KEY
                       DISPLAY 'Loan ID ' WS-LOAN-ID ' not found.'
                   NOT INVALID KEY
                       ADD WS-PAYMENTS TO PAID-MONTHS
                       IF PAID-MONTHS >= TERM-MONTHS
                           MOVE 'CLOSED' TO STATUSS
                       END-IF
                       REWRITE LOAN-RECORD
                       DISPLAY 'Loan ' WS-LOAN-ID ' updated successfully.'
               END-READ
           END-PERFORM

           CLOSE LOAN-FILE
           DISPLAY 'All updates finished.'
           STOP RUN.
