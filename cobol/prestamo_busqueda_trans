       IDENTIFICATION DIVISION.
       PROGRAM-ID. LOAN_QUERY_ONLINE.
       AUTHOR. YOUR-NAME.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT LOAN-FILE ASSIGN TO 'LOANS.DAT'
               ORGANIZATION IS INDEXED
               ACCESS MODE IS DYNAMIC
               RECORD KEY IS LOAN-ID
               FILE STATUS IS WS-FS-LOAN.

       DATA DIVISION.
       FILE SECTION.
       FD LOAN-FILE.
       01 LOAN-RECORD.
           05 LOAN-ID        PIC 9(6).
           05 CLIENT-ID      PIC 9(6).
           05 AMOUNT         PIC 9(9)V99.
           05 INTEREST       PIC 9(3)V99.
           05 TERM-MONTHS    PIC 9(3).
           05 STATUSS        PIC X(10).
           05 PAID-MONTHS    PIC 9(3).

       WORKING-STORAGE SECTION.
       01 WS-LOAN-ID       PIC 9(6) VALUE 0.
       01 WS-FS-LOAN       PIC XX.
       01 WS-EXIT          PIC X VALUE 'N'.
           88 EXIT-PROGRAM VALUE 'Y'.
           88 CONTINUE-PROGRAM VALUE 'N'.

       PROCEDURE DIVISION.
           OPEN INPUT LOAN-FILE

           PERFORM UNTIL EXIT-PROGRAM
               DISPLAY 'Enter Loan ID to query (0 to exit): '
               ACCEPT WS-LOAN-ID

               IF WS-LOAN-ID = 0
                   SET EXIT-PROGRAM TO TRUE
               ELSE
                   READ LOAN-FILE KEY IS WS-LOAN-ID
                       INVALID KEY
                           DISPLAY 'Loan ID ' WS-LOAN-ID ' not found.'
                       NOT INVALID KEY
                           DISPLAY 'Loan found:'
                           DISPLAY 'ID: ' LOAN-ID
                           DISPLAY 'Client: ' CLIENT-ID
                           DISPLAY 'Amount: ' AMOUNT
                           DISPLAY 'Interest: ' INTEREST
                           DISPLAY 'Term: ' TERM-MONTHS
                           DISPLAY 'Paid Months: ' PAID-MONTHS
                           DISPLAY 'Status: ' STATUSS
                           DISPLAY '---------------------------'
                   END-READ
               END-IF
           END-PERFORM

           CLOSE LOAN-FILE
           DISPLAY 'Loan query session ended.'
           STOP RUN.
