 IDENTIFICATION DIVISION.
       PROGRAM-ID. LOAN_QUERY.
       AUTHOR. YOUR-NAME.
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT LOAN-FILE ASSIGN TO 'LOANS.DAT'
               ORGANIZATION IS INDEXED
               ACCESS MODE IS SEQUENTIAL
               RECORD KEY IS LOAN-ID.

       DATA DIVISION.
       FILE SECTION.
       FD  LOAN-FILE.
       01  LOAN-RECORD.
           05 LOAN-ID         PIC 9(6).
           05 CLIENT-ID       PIC 9(6).
           05 AMOUNT          PIC 9(9)V99.
           05 INTEREST        PIC 9(5)V99.
           05 TERM-MONTHS     PIC 9(3).
           05 STATUS          PIC X(10).
           05 PAID-MONTHS     PIC 9(3).

       WORKING-STORAGE SECTION.
       01  WS-CLIENT-ID      PIC 9(6).
       01  WS-MESSAGE        PIC X(50).

       PROCEDURE DIVISION.
           OPEN INPUT LOAN-FILE
           DISPLAY 'LOAN QUERY MODULE INITIATED'
           DISPLAY 'Enter Client ID to search: '
           ACCEPT WS-CLIENT-ID
           PERFORM SEARCH-LOANS
           CLOSE LOAN-FILE
           STOP RUN.

       SEARCH-LOANS.
           READ LOAN-FILE
               AT END DISPLAY 'No loans found for Client ID ' WS-CLIENT-ID
           NOT AT END
               PERFORM UNTIL LOAN-ID = 0
                   IF CLIENT-ID = WS-CLIENT-ID
                       DISPLAY 'Loan ID: ' LOAN-ID
                       DISPLAY 'Amount: ' AMOUNT
                       DISPLAY 'Interest: ' INTEREST
                       DISPLAY 'Term: ' TERM-MONTHS
                       DISPLAY 'Status: ' STATUS
                       DISPLAY 'Paid Months: ' PAID-MONTHS
                       DISPLAY '-------------------------'
                   END-IF
                   READ LOAN-FILE
                       AT END MOVE 0 TO LOAN-ID
                   END-READ
               END-PERFORM.
