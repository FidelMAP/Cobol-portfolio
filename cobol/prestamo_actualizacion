IDENTIFICATION DIVISION.
       PROGRAM-ID. LOAN_UPDATE.
       AUTHOR. YOUR-NAME.
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT LOAN-FILE ASSIGN TO 'LOANS.DAT'
               ORGANIZATION IS INDEXED
               ACCESS MODE IS SEQUENTIAL
               RECORD KEY IS LOAN-ID.
       DATA DIVISION.
       FILE SECTION.
       FD  LOAN-FILE.
       01  LOAN-RECORD.
           05 LOAN-ID         PIC 9(6).
           05 CLIENT-ID       PIC 9(6).
           05 AMOUNT          PIC 9(9)V99.
           05 INTEREST        PIC 9(5)V99.
           05 TERM-MONTHS     PIC 9(3).
           05 STATUS          PIC X(10).
           05 PAID-MONTHS     PIC 9(3).
       WORKING-STORAGE SECTION.
       01  WS-MONTHLY-PAYMENT  PIC 9(9)V99.
       01  WS-MESSAGE          PIC X(50).
       01  CURRENT-DATE        PIC 9(8) VALUE 20250901.
       01  DUE-DATE            PIC 9(8) VALUE 20250930.
       PROCEDURE DIVISION.
           OPEN I-O LOAN-FILE
           DISPLAY 'LOAN UPDATE MODULE INITIATED'
           PERFORM PROCESS-LOANS
           CLOSE LOAN-FILE
           STOP RUN.

       PROCESS-LOANS.
           READ LOAN-FILE
               AT END MOVE 'END OF FILE' TO WS-MESSAGE
           NOT AT END
               DISPLAY 'Processing Loan ID: ' LOAN-ID
               PERFORM CALCULATE-PAYMENT
               PERFORM UPDATE-STATUS
           END-READ.

       CALCULATE-PAYMENT.
           COMPUTE WS-MONTHLY-PAYMENT = (AMOUNT + (AMOUNT * INTEREST/100)) / TERM-MONTHS
           DISPLAY 'Monthly Payment: ' WS-MONTHLY-PAYMENT
           .

       UPDATE-STATUS.
           IF PAID-MONTHS >= TERM-MONTHS
               MOVE 'CLOSED' TO STATUS
           ELSE IF CURRENT-DATE > DUE-DATE
               MOVE 'OVERDUE' TO STATUS
           ELSE
               MOVE 'ACTIVE' TO STATUS
           END-IF
           DISPLAY 'Loan Status Updated: ' STATUS
