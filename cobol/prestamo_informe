 IDENTIFICATION DIVISION.
       PROGRAM-ID. LOAN_REPORT.
       AUTHOR. YOUR-NAME.
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT LOAN-FILE ASSIGN TO 'LOANS.DAT'
               ORGANIZATION IS INDEXED
               ACCESS MODE IS SEQUENTIAL
               RECORD KEY IS LOAN-ID.

       DATA DIVISION.
       FILE SECTION.
       FD  LOAN-FILE.
       01  LOAN-RECORD.
           05 LOAN-ID         PIC 9(6).
           05 CLIENT-ID       PIC 9(6).
           05 AMOUNT          PIC 9(9)V99.
           05 INTEREST        PIC 9(5)V99.
           05 TERM-MONTHS     PIC 9(3).
           05 STATUS          PIC X(10).
           05 PAID-MONTHS     PIC 9(3).

       WORKING-STORAGE SECTION.
       01  WS-TOTAL-ACTIVE    PIC 9(6) VALUE 0.
       01  WS-TOTAL-OVERDUE   PIC 9(6) VALUE 0.
       01  WS-TOTAL-CLOSED    PIC 9(6) VALUE 0.

       PROCEDURE DIVISION.
           OPEN INPUT LOAN-FILE
           DISPLAY 'LOAN REPORT MODULE INITIATED'
           PERFORM GENERATE-REPORT
           DISPLAY 'Report Summary: '
           DISPLAY 'Active Loans: ' WS-TOTAL-ACTIVE
           DISPLAY 'Overdue Loans: ' WS-TOTAL-OVERDUE
           DISPLAY 'Closed Loans: ' WS-TOTAL-CLOSED
           CLOSE LOAN-FILE
           STOP RUN.

       GENERATE-REPORT.
           READ LOAN-FILE
               AT END MOVE 0 TO LOAN-ID
           NOT AT END
               PERFORM UNTIL LOAN-ID = 0
                   EVALUATE STATUS
                       WHEN 'ACTIVE' MOVE WS-TOTAL-ACTIVE + 1 TO WS-TOTAL-ACTIVE
                       WHEN 'OVERDUE' MOVE WS-TOTAL-OVERDUE + 1 TO WS-TOTAL-OVERDUE
                       WHEN 'CLOSED' MOVE WS-TOTAL-CLOSED + 1 TO WS-TOTAL-CLOSED
                       WHEN OTHER CONTINUE
                   END-EVALUATE
                   READ LOAN-FILE
                       AT END MOVE 0 TO LOAN-ID
                   END-READ
               END-PERFORM.
